# 慧云AI - 天气与天文信息平台需求文档

## 1. 背景

随着人们对户外活动和天文观测兴趣的增加，对准确的天气信息和天文数据的需求日益增长。传统的天气预报应用往往只提供基本的气象信息，而缺乏针对天文观测（如观星）的专业数据支持。同时，用户希望能够通过智能助手快速获取个性化的天气与出行建议。

慧云AI应运而生，旨在为用户提供全面的天气信息和专业的天文观测数据，并结合AI技术提供智能化的咨询服务，帮助用户更好地规划户外活动和天文观测。

## 2. 目标

- 提供准确、实时的天气信息（当前天气、未来预报）
- 提供专业的天文观测数据（观星指数、月相、光污染等）
- 结合AI技术提供个性化的天气与天文咨询服务
- 打造直观、易用的用户界面，提升用户体验
- 支持多城市查询，满足不同地区用户的需求

## 3. 环境

### 3.1 技术栈

#### 前端
- HTML5
- CSS3
- JavaScript (ES6+)
- Axios (HTTP请求库)
- Emoji Mart (表情选择器)
- Material Symbols (图标库)
- qweather-icons (天气图标库)

#### 后端
- Python 3.12
- FastAPI (Web框架)
- Requests (HTTP请求库)
- OpenAI Python SDK (AI接口)
- Uvicorn (ASGI服务器)

### 3.2 依赖服务
- 和风天气API (天气数据)
- 天文通API (光污染数据)
- 通义千问API (AI助手)

### 3.3 运行环境
- 开发环境：本地开发服务器 (端口8000)
- 浏览器支持：现代浏览器 (Chrome, Firefox, Safari, Edge)

## 4. 功能列表

### 4.1 核心功能

#### 4.1.1 天气信息展示
- 当前天气基本信息（温度、天气状况、昼夜温差）
- 天气详细信息（湿度、气压、能见度、风速、风向、云量、紫外线）
- 未来天气预报（按天、按小时）
- 城市搜索与切换功能

#### 4.1.2 天文信息展示
- 观星指数（当前及未来三天）
- 月相信息（月相图标、月升月落时间）
- 光污染数据（波特尔光害等级、SQM值）
- 相关外部资源链接（星空地图、光污染地图、卫星云图、视宁度）

#### 4.1.3 AI智能助手
- 天气与出行信息咨询
- 天文与观星信息咨询
- 支持文本输入和表情发送
- 流式响应展示

### 4.2 辅助功能

#### 4.2.1 用户界面
- 星空背景动画效果
- 响应式设计，适配不同屏幕尺寸
- 直观的信息卡片布局
- 错误提示与用户反馈

#### 4.2.2 数据管理
- 数据缓存机制，减少API调用次数
- 城市切换时的数据更新
- 测试数据支持，便于开发和调试

## 5. 项目结构
```
HuiyunAI/
├── backend/ # 后端代码 
│ ├── pycache/ # Python缓存文件 
│ ├── test_data/ # 测试数据文件 
│ ├── api_keys.py # API密钥配置 
│ ├── data_api.py # 数据API接口 
│ ├── get_jwt.py # JWT令牌获取 
│ ├── requirements.txt # 依赖包列表 
│ ├── server.py # FastAPI服务器 
│ └── system_prompt.txt # AI系统提示词 
├──  frontend/ # 前端代码
│ ├── node_modules/ # 前端依赖
│ ├── static/ # 静态资源
│ │  ├── imgs/ # 图片资源
│ │  ├── scripts/ # JavaScript脚本
│ │  ├── styles/ # CSS样式
│ └── index.html # 主HTML文件
```

## 6. API接口

### 6.1 测试接口
- `/test/day_data` - 获取测试日天气数据
- `/test/hourly_data` - 获取测试小时天气数据
- `/test/light_pollution` - 获取测试光污染数据
- `/test/loc_data` - 获取测试地理位置数据

### 6.2 业务接口
- `/api/day_data` - 获取实际日天气数据
- `/api/hourly_data` - 获取实际小时天气数据
- `/api/light_pollution` - 获取实际光污染数据
- `/api/loc_data` - 获取实际地理位置数据
- `/api/chat` - AI助手咨询接口

## 7. 预期效果

- 用户能够快速查询任意城市的天气信息
- 用户能够获取专业的天文观测数据和观星建议
- 用户能够通过AI助手获得个性化的天气与天文咨询服务
- 界面美观、响应迅速，提供良好的用户体验